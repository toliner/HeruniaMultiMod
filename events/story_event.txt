add_namespace = story

country_event = {
    id = story.1
    title = story.1.t
    desc = story.1.d
    is_triggered_only = yes
    
    option = {
        name = story.1.a
        
        annex_country = {
            target = GUA
        }
        annex_country = {
            target = ELS
        }
        annex_country = {
            target = HON
        }
        annex_country = {
            target = NIC
        }
        annex_country = {
            target = COS
        }
        annex_country = {
            target = PAN
        }
        annex_country = {
            target = CUB
        }
        annex_country = {
            target = HAI
        }
        annex_country = {
            target = DOM
        }
        annex_country = {
            target = COL
        }
        annex_country = {
            target = VEN
        }
        annex_country = {
            target = ECU
        }
        annex_country = {
            target = PRU
        }
        annex_country = {
            target = BOL
        }
        annex_country = {
            target = CHL
        }
        annex_country = {
            target = PAR
        }
        annex_country = {
            target = URG
        }
        annex_country = {
            target = BRA
        }
        annex_country = {
            target = MEX
        }
        
        set_political_party = {
            ideology = democratic
            popularity = 100
        }
        set_politics = {
            ruling_party = democratic
            elections_allowed = no
            last_election = "1935.12.17"
            election_frequency = 48
        }
        add_ideas = {
            free_trade
            undisturbed_isolation
            ENG_the_war_to_end_all_wars
            HOL_de_crisisjaren_5
            HOL_shell_shocked_spectator_5
            HOL_aloof_neutrality
            FRA_inefficient_economy_2
            FRA_full_employment
            FRA_disjointed_government
            FRA_victors_of_wwi
            SPR_military_disloyalty
            SPR_national_strikes_3
            CHI_hyper_inflation_3
            CHI_incompetent_officers
            CHI_army_corruption_1
            great_depression
            GRE_schachtplan
            GRE_foreign_monopolies
            GRE_agrarian_society
            BUL_army_restrictions
            JAP_hirohito
        }
        set_stability = 1
        delete_unit_template_and_units = {
            division_template = "División de Infanteria"
        }
        delete_unit_template_and_units = {
            division_template = "Brigada Montaña"
        }
        delete_unit_template_and_units = {
            division_template = "División de Caballería"
        }
        
        country_event = {
            id = story.100
            days = 7
        }
    }
}

country_event = {
    id = story.2
    title = story.2.t
    desc = story.2.d
    is_triggered_only = yes
    
    option = {
        name = story.2.a
        
        annex_country = {
            target = FIN
            transfer_troops = yes
        }
        annex_country = {
            target = SWE
            transfer_troops = yes
        }
        annex_country = {
            target = DEN
            transfer_troops = yes
        }
        add_timed_idea = {
            idea = POL_four_year_plan_complete_4
            days = 730
        }
        country_event = {
            id = story.100
            days = 7
        }
    }
}

country_event = {
    id = story.3
    title = story.3.t
    desc = story.3.d
    is_triggered_only = yes
    
    option = {
        name = story.3.a
        
        annex_country = {
            target = LAT
            transfer_troops = yes
        }
        annex_country = {
            target = LIT
            transfer_troops = yes
        }
        add_timed_idea = {
            idea = POL_four_year_plan_complete_4
            days = 730
        }
        country_event = {
            id = story.100
            days = 7
        }
    }
}

country_event = {
    id = story.4
    title = story.4.t
    desc = story.4.d
    is_triggered_only = yes
    
    option = {
        name = story.4.a
        
        annex_country = {
            target = XSM
            transfer_troops = yes
        }
        annex_country = {
            target = GXC
            transfer_troops = yes
        }
        annex_country = {
            target = TIB
            transfer_troops = yes
        }
        annex_country = {
            target = SIK
            transfer_troops = yes
        }
        annex_country = {
            target = MON
            transfer_troops = yes
        }
        add_timed_idea = {
            idea = POL_four_year_plan_complete_4
            days = 730
        }
        
        country_event = {
            id = story.100
            days = 7
        }
    }
}

country_event = {
    id = story.5
    title = story.5.t
    desc = story.5.d
    is_triggered_only = yes
    
    option = {
        name = story.5.a
        
        HOL = {
            end_puppet = INS
        }
        annex_country = {
            target = HOL
            transfer_troops = yes
        }
        set_cosmetic_tag = UNL_UNIFIED
        hidden_effect = {
            news_event = { id = wtt_news.58 hours = 6 }
            set_global_flag = form_united_netherlands_flag
        }
        
        country_event = {
            id = story.100
            days = 7
        }
    }
}

# ソ連による併合, スペイン内戦終了時に呼ばれる
country_event = {
    id = story.6
    title = story.6.t
    desc = story.6.d
    is_triggered_only = yes
    
    option = {
        name = story.6.a
        annex_country = {
            target = EST
            transfer_troops = yes
        }
        annex_country = {
            target = TAN
            transfer_troops = yes
        }
        annex_country = {
            target = PER
            transfer_troops = yes
        }
        annex_country = {
            target = TUR
            transfer_troops = yes
        }
        country_event = {
            id = story.101
            days = 7
        }
    }
}

# ドイツによるハンガリーとルーマニア併合, スペイン内戦終了時に呼ばれる
country_event = {
    id = story.7
    title = story.7.t
    desc = story.7.d
    is_triggered_only = yes
    
    option = {
        name = story.7.a
        annex_country = {
            target = HUN
            transfer_troops = yes
        }
        annex_country = {
            target = ROM
            transfer_troops = yes
        }
        annex_country = {
            target = NOR
            transfer_troops = yes
        }
        SOV = {
            transfer_state = 80
            transfer_state = 78
            transfer_state = 766
        }
        add_to_faction = ITA
        add_to_faction = SOV
        JAP = {
            dismantle_faction = yes
        }
        add_to_faction = JAP
        country_event = {
            id = story.101
            days = 7
        }
    }
}

# イタリアによるブルガリア併合
country_event = {
    id = story.8
    title = story.8.t
    desc = story.8.d
    is_triggered_only = yes
    
    option = {
        name = story.8.a
        annex_country = {
            target = BUL
            transfer_troops = yes
        }
        annex_country = {
            target = ALB
            transfer_troops = yes
        }
        country_event = {
            id = story.101
            days = 7
        }
    }
}

# フランスが独自陣営設立
country_event = {
    id = story.9
    title = story.9.t
    desc = story.9.d
    is_triggered_only = yes
    
    option = {
        name = story.9
        annex_country = {
            target = SPA
            transfer_troops = yes
        }
        annex_country = {
            target = SPB
            transfer_troops = yes
        }
        annex_country = {
            target = SPC
            transfer_troops = yes
        }
        annex_country = {
            target = SPD
            transfer_troops = yes
        }
        leave_faction = yes
        create_faction = "#宥和政策を許さない"
        add_to_faction = POL
        add_to_faction = BEL
        add_to_faction = SWI
    }
}

# 日本
country_event = {
    id = story.10
    title = story.10.t
    desc = story.10.d
    is_triggered_only = yes
    
    option = {
        name = story.10.a
        
        end_puppet = MAN
        end_puppet = MEN
        annex_country = {
            target = MAN
            transfer_troops = yes
        }
        annex_country = {
            target = MEN
            transfer_troops = yes
        }
        annex_country = {
            target = CHI
            transfer_troops = yes
        }
        USA = {
            end_puppet = PHI
        }
        annex_country = {
            target = PHI
            transfer_troops = yes
        }
        transfer_state = 670
        transfer_state = 671
        transfer_state = 286
        transfer_state = 741
        transfer_state = 289
        country_event = {
            id = story.101
            days = 7
        }
    }
}

country_event = {
    id = story.11
    title = story.11.t
    desc = story.11.d
    is_triggered_only = yes
    
    option = {
        name = story.11.a
        create_faction = "憲法9条を守る会"
        add_to_faction = ARG
        add_to_faction = POR
    }
}

news_event = {
    id = story.12
    title = story.12.t
    desc = story.12.d
    is_triggered_only = yes
    major = yes
    picture = GFX_news_event_nuke
    option = {
        name = story.12.a
    }
}

country_event = {
    id = story.13
    title = story.13.t
    desc = story.13.d
    is_triggered_only = yes
    
    option = {
        name = story.13.a
        
        add_to_variable = {
            global.herunia = 2
        }
        country_event = {
            id = story.14
        }
    }
    option = {
        name = story.13.b
        
        add_to_variable = {
            global.marisa = 2
        }
        country_event = {
            id = story.14
        }
    }
    option = {
        name = story.13.c
        
        add_to_variable = {
            global.alice = 2
        }
        country_event = {
            id = story.14
        }
    }
}

country_event = {
    id = story.14
    title = story.14.t
    desc = story.14.d
    is_triggered_only = yes
    
    immediate = {
        set_global_flag = HRE_great_war_happened
        GER = {
            add_idas = HERUNIA_GER_surrender_limit
            declare_war_on = {
                target = ENG
                type = annex_everything
            }
        }
        JAP = {
            add_ideas = HERUNIA_JAP_surrender_limit
            declare_war_on = {
                target = ENG
                type = annex_everything
            }
        }
        ITA = {
            add_ideas = HERUNIA_ITA_surrender_limit
            declare_war_on = {
                target = ENG
                type = annex_everything
            }
        }
        SOV = {
            add_ideas = HERUNIA_SOV_surrender_limit
            declare_war_on = {
                target = ENG
                type = annex_everything
            }
        }
        # マリアリ投票結果確定
        if = {
            # マリアリ
            limit = {
                check_variable = {
                    global.alice > 7
                }
                check_variable = {
                    global.marisa > 7
                }
            }
            set_global_flag = HERUNIA_VOTE_MARIALI
        }
        else_if = {
            # アリス
            limit = {
                check_variable = {
                    global.alice > global.marisa
                }
                check_variable = {
                    global.alice > global.herunia
                }
            }
            set_global_flag = HERUNIA_VOTE_ALICE
        }
        else_if = {
            # 魔理沙
            limit = {
                check_variable = {
                    global.marisa > global.herunia
                }
            }
            set_global_flag = HERUNIA_VOTE_MARISA
        }
        else = {
            set_global_flag = HERUNIA_VOTE_HERUNIA
        }
        if = {
            limit = {
                has_global_flag = HERUNIA_FLAG_HONBAN
            }
            news_event = herunia.107
            every_country = {
                limit = {
                    is_hre_country = yes
                }
                country_event = {
                    id = herunia.24
                }
            }
        }
    }
}

news_event = {
    id = story.15
    title = story.15.t
    desc = story.15.d
    is_triggered_only = yes
    major = yes
    picture = GFX_herunia_enjou
    immediate = {
        hidden_effect = {
            every_country = {
                limit = {
                    is_ai = no
                }
                play_song = "プラネタリウムガーデン"
            }
        }
    }
    option = {
        name = story.15.a
    }
}

country_event = {
    id = story.100
    title = story.100.t
    desc = story.100.d
    is_triggered_only = yes
    hidden = yes
    
    immediate = {
        every_controlled_state = {
            set_variable = { ROOT.remove_core_target_state = THIS }
            for_each_scope_loop = {
                array = ROOT.remove_core_target_state:core_countries
                remove_state_core = ROOT.remove_core_target_state
            }
            if = {
                limit = {
                    NOT = {
                        is_core_of = ROOT
                    }
                }
                add_core_of = ROOT
            }
        }
        clear_variable = ROOT.remove_core_target_state
    }
}

country_event = {
    id = story.101
    title = story.101.t
    desc = story.101.d
    is_triggered_only = yes
    hidden = yes
    
    immediate = {
        every_controlled_state = {
            limit = {
                NOT = {
                    is_core_of = ROOT
                }
            }
            add_core_of = ROOT
        }
    }
}